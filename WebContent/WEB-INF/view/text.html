<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .p{
            color: red;
        }
    </style>
</head>
<body>
<span  class="p">fsdfsdafs</span>
<script>

    var _json3 = {
        "children": [{
            "text": "一、医疗质控信息",
            "id": "#C1",
            "order": "一、",
            "children": [{
                "text": "（一）重发暴雨",
                "id": "#C2.1",
                "order": "（一）",
                "state": "open",
                "domId": "_easyui_tree_3",
                "target": {"jQuery1113004363655792849119": 51},
                "children":[]
            },
                {
                "text": "（二）好的很",
                "id": "#C2.2",
                "order": "（二）",
                "state": "open",
                "domId": "_easyui_tree_4",
                "target": {"jQuery1113004363655792849119": 55}
                ,"children":[]
            }, {
                "text": "（三）好的很",
                "id": "#C2.2",
                "order": "（三）",
                "state": "open",
                "domId": "_easyui_tree_5",
                "target": {"jQuery1113004363655792849119": 59}
                ,"children":[]
            }],
            "state": "open",
            "domId": "_easyui_tree_2",
            "target": {"jQuery1113004363655792849119": 47}
        }, {
            "text": "二、医疗质控工作小结",
            "id": "#C2",
            "order": "二、",
            "children": [{
                "text": "（一）住院病历质控",
                "id": "#C2.1",
                "order": "（一）",
                "children": [{
                    "text": "A、时间考虑到附近",
                    "id": "#C2.1",
                    "order": "A、",
                    "state": "open",
                    "domId": "_easyui_tree_21",
                    "target": {"jQuery1113004363655792849119": 79}
                    ,"children":[]
                }, {
                    "text": "1、重发暴雨",
                    "id": "#C2.1",
                    "order": "1、",
                    "state": "open",
                    "domId": "_easyui_tree_8",
                    "target": {"jQuery1113004363655792849119": 71, "entered": true}
                    ,"children":[]
                }, {
                    "text": "2、好的很",
                    "id": "#C2.2",
                    "order": "2、",
                    "children": [{
                        "text": "B、大师法",
                        "id": "#C2.2",
                        "order": "B、",
                        "children": [
                                {
                            "text": "a、重发暴雨",
                            "id": "#C2.1",
                            "order": "a、",
                            "state": "open",
                            "domId": "_easyui_tree_12",
                            "target": {"jQuery1113004363655792849119": 87}
                            ,"children":[]
                        },
                            {
                            "text": "b、好的很",
                            "id": "#C2.2",
                            "order": "b、",
                            "state": "open",
                            "domId": "_easyui_tree_13",
                            "target": {"jQuery1113004363655792849119": 91}
                            ,"children":[]
                        },
                            {
                            "text": "c、好的很",
                            "id": "#C2.2",
                            "order": "c、",
                            "state": "open",
                            "domId": "_easyui_tree_14",
                            "target": {"jQuery1113004363655792849119": 95}
                            ,"children":[]
                        }
                        ],
                        "state": "open",
                        "domId": "_easyui_tree_11",
                        "target": {"jQuery1113004363655792849119": 83}
                    }, {
                        "text": "C、第三方的手",
                        "id": "#C2.2",
                        "order": "C、",
                        "state": "open",
                        "domId": "_easyui_tree_15",
                        "target": {"jQuery1113004363655792849119": 99}
                        ,"children":[]
                    }],
                    "state": "open",
                    "domId": "_easyui_tree_9",
                    "target": {"jQuery1113004363655792849119": 75, "entered": false}
                }, {
                    "text": "3、好的很",
                    "id": "#C2.2",
                    "order": "3、",
                    "state": "open",
                    "domId": "_easyui_tree_16",
                    "target": {"jQuery1113004363655792849119": 103}
                    ,"children":[]
                }],
                "state": "open",
                "domId": "_easyui_tree_7",
                "target": {"jQuery1113004363655792849119": 67}
            }, {
                "text": "（二）门、急诊工作",
                "id": "#C2.2",
                "order": "（二）",
                "state": "open",
                "domId": "_easyui_tree_17",
                "target": {"jQuery1113004363655792849119": 107}
                ,"children":[]
            }, {
                "text": "（三）医技科室",
                "id": "#C2.3",
                "order": "（三）",
                "state": "open",
                "domId": "_easyui_tree_18",
                "target": {"jQuery1113004363655792849119": 111}
                ,"children":[]
            }, {
                "text": "（四）科室相关质控工作检查反馈",
                "id": "#C2.4",
                "order": "（四）",
                "state": "open",
                "domId": "_easyui_tree_19",
                "target": {"jQuery1113004363655792849119": 115}
                ,"children":[]
            }],
            "state": "open",
            "domId": "_easyui_tree_6",
            "target": {"jQuery1113004363655792849119": 63}
        }, {
            "text": "三、整改意见",
            "id": "#C3",
            "order": "三、",
            "state": "open",
            "domId": "_easyui_tree_20",
            "target": {"jQuery1113004363655792849119": 119}
            ,"children":[]
        }],
        "text": "目 录",
        "id": "#C1",
        "order": "",
        "state": "open",
        "domId": "_easyui_tree_1",
        "target": {"jQuery1113004363655792849119": 43}
    };

    var _json = {
        "children": [{
            "children": [{
                "children": [{
                    "children": [],
                    "content": "",
                    "distance": 0,
                    "id": 350,
                    "order": "1",
                    "par_id": 318,
                    "paragraph_id": 470,
                    "text": "新5",
                    "state": "open",
                    "domId": "_easyui_tree_14",
                    "target": {"pageY": 146}
                }, {
                    "children": [],
                    "content": "",
                    "distance": 0,
                    "id": 320,
                    "order": "2",
                    "par_id": 6,
                    "paragraph_id": 440,
                    "text": "进攻打法",
                    "state": "open",
                    "domId": "_easyui_tree_4"
                }, {
                    "children": [],
                    "content": "",
                    "distance": 0,
                    "id": 321,
                    "order": "3",
                    "par_id": 6,
                    "paragraph_id": 441,
                    "text": "中场打法",
                    "state": "open",
                    "domId": "_easyui_tree_5"
                }],
                "content": "",
                "distance": 0,
                "id": 6,
                "order": "(二).",
                "par_id": 4,
                "paragraph_id": 230,
                "text": "门诊工作",
                "state": "open",
                "domId": "_easyui_tree_3",
                "target": {"jQuery11130507155963828726": 50}
            }, {
                "children": [],
                "content": "",
                "distance": 0,
                "id": 7,
                "order": "(三).",
                "par_id": 4,
                "paragraph_id": 240,
                "text": "医技科室",
                "state": "open",
                "domId": "_easyui_tree_6"
            }, {
                "children": [{
                    "children": [],
                    "content": "",
                    "distance": 0,
                    "id": 351,
                    "order": "2",
                    "par_id": 318,
                    "paragraph_id": 471,
                    "text": "新1",
                    "state": "open",
                    "domId": "_easyui_tree_9"
                }, {
                    "children": [],
                    "content": "",
                    "distance": 0,
                    "id": 352,
                    "order": "3",
                    "par_id": 318,
                    "paragraph_id": 472,
                    "text": "示范点",
                    "state": "open",
                    "domId": "_easyui_tree_10"
                }, {
                    "children": [],
                    "content": "",
                    "distance": 0,
                    "id": 353,
                    "order": "4",
                    "par_id": 318,
                    "paragraph_id": 473,
                    "text": "发生大",
                    "state": "open",
                    "domId": "_easyui_tree_11"
                }, {
                    "children": [],
                    "content": "",
                    "distance": 0,
                    "id": 354,
                    "order": "5",
                    "par_id": 318,
                    "paragraph_id": 474,
                    "text": "选择",
                    "state": "open",
                    "domId": "_easyui_tree_12"
                }],
                "content": "",
                "distance": 0,
                "id": 318,
                "order": "(四).",
                "par_id": 4,
                "paragraph_id": 438,
                "text": "发生大",
                "state": "open",
                "domId": "_easyui_tree_7",
                "target": {"jQuery11130507155963828726": 66, "entered": false}
            }],
            "content": "",
            "distance": 0,
            "id": 4,
            "order": "一.",
            "par_id": 1,
            "paragraph_id": 230,
            "text": "医疗质控工作小结",
            "state": "open",
            "domId": "_easyui_tree_2",
            "target": {"jQuery11130507155963828726": 46}
        }, {
            "children": [],
            "content": "",
            "distance": 0,
            "id": 8,
            "order": "二.",
            "par_id": 1,
            "paragraph_id": 230,
            "text": "整改意见",
            "state": "open",
            "domId": "_easyui_tree_13"
        }],
        "content": "",
        "distance": 0,
        "id": 1,
        "order": "",
        "par_id": 0,
        "paragraph_id": 240,
        "text": "目录",
        "state": "open",
        "domId": "_easyui_tree_1",
        "target": {"jQuery11130507155963828726": 42}
    }
    var _arr = [] ,workSpace=[];
    _arr[0] = {};
    _arr[0].text = _json.text;
    _arr[0].id = _json.id;
    _arr[0].order = _json.order;
    _arr[0].children = [];

    function recursion(obj, tempObj) {
        console.log(obj,"循环数组")
        if(obj.children.length>0){
            var addArr=[];
            for (var i = 0; i < obj.children.length; i++) {
                !function (i) {
                    addArr.push(obj.children[i])
                    //tempObj.push(obj.children[i]);/*添加*/
                }(i)
                if (i==obj.children.length-1) {/*添加完*/
                    tempObj=addArr.concat(tempObj);
                    console.log(tempObj.length,"开始");
                    var temp = JSON.stringify(tempObj[0]);
                    temp=JSON.parse(temp);
                    var item = {
                        "text": temp.text,
                        "id": temp.id,
                        "order": temp.order,
                        "children": [],
                    }
                    _arr.push(item);
                    console.log(_arr,"得到的数组");
                    var del=tempObj.shift();/*删掉头部*/
                    console.log(del,"/*删掉头部*/");
                    console.log(tempObj,"删掉后的tempObj2");
                    if(del.children.length>0){
                        recursion(del, tempObj)
                    }else{
                        console.log(tempObj,"tempObj3");
                        for (var j = 0,leg=tempObj.length; j <leg; j++) {
                            console.log(tempObj,tempObj.length,"减少长度");
                            console.log(tempObj[0],"tempObj[0]")
                            if(tempObj[0].children.length>0){
                                console.log(tempObj[0],"tempObj[0]")
                                var  _del= tempObj.shift();/*删掉头部*/
                                _del = JSON.stringify(_del);
                                _del=JSON.parse(_del);
                                var _item = {
                                    "text": _del.text,
                                    "id": _del.id,
                                    "order": _del.order,
                                    "children": [],
                                }
                                _arr.push(_item);
                                console.log(_arr,"_arr");
                                console.log(tempObj,"tempObj");
                                recursion(_del, tempObj);
                                break;
                            }else{
                                var  _del= tempObj.shift();/*删掉头部*/
                                console.log(_del,"_del");
                                console.log(tempObj,"tempObj4");
                                _del = JSON.stringify(_del);
                                _del=JSON.parse(_del);
                                var _item = {
                                    "text": _del.text,
                                    "id": _del.id,
                                    "order": _del.order,
                                    "children": [],
                                }
                                _arr.push(_item);
                                console.log(_arr,"arr")
                            }
                        }


                    }

                }
            }
        }else{
            return ;
        }
    }
    recursion(_json, workSpace);
    console.log(_arr,"最后");

</script>
</body>
</html>